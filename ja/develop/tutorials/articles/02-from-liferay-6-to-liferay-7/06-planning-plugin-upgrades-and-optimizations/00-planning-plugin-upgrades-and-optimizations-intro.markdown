---
header-id: migrating-existing-code-to-liferay-7
---

# プラグインのアップグレードと最適化の計画

[TOC levels=1-4]

@product-ver@の機能を探究し、Liferayの新しい[ツール](/docs/7-1/tutorials/-/knowledge_base/t/improved-developer-tooling-liferay-workspace-maven-plugins-and-more)および[テクニック](/docs/7-1/tutorials/-/knowledge_base/t/osgi-and-modularity-for-liferay-6-developers)で新しいポートレットモジュールテーマを作成した場合、既存のプラグインをどのようにアップグレードしたのかを疑問に思うかもしれません。 優れた点は、Liferayがアップグレードプロセスの大部分を自動化したということです。 加えて、従来の方法でプラグインの開発を続行し、準備ができた時に新しい開発ツールとテクニックを導入するということができます。

このチュートリアルでは、プラグインを*アップグレード*し、オプションでそれらを*最適化*するフェーズについて説明します。

**アップグレード**：最小限の変更で@product-ver@に既存のプラグインをデプロイするプロセスです。

**最適化**：プラグインを改善したり、開発を促進したりするために、プラグインを変更したり、新しい環境に移行したりするプロセスです。オプションですが推奨されています。

重要なのは、最適化を適用する前にプラグインを*アップグレード*しなければならないということです。

プラグインは@product-ver@へ簡単にアップグレードできます。 プラグインSDKおよびMavenプロジェクトの場合、Liferay @ide@の[Upgrade Planner](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)がプロセスの大部分を自動化します。 [upgrade tutorials](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-plugins-to-liferay-7)ではさらに、残りのアップグレード手順について説明しています。

以前のリリース（例: `ant clean deploy`）と同じように、プラグインを@product-ver@にデプロイできます。 しかし、@product-ver@のすべてがOSGiモジュールとして実行されるため、従来のWARスタイルのプラグインをどのように実行できるのか疑問に思うかもしれません。 Liferayのプラグイン互換性レイヤーに、その答えがあります。

プラグイン互換性レイヤーは、標準のWARをWebアプリケーションバンドル（WAB）に変換します。 WABは本格的なOSGiモジュールです。 プラグイン互換性レイヤーの[WAB Generator](/docs/7-1/tutorials/-/knowledge_base/t/using-the-wab-generator)は、OSGi固有の変更を加えることなく、Servlets、JSP、およびその他のJava Webテクノロジーを含む従来のプラグインおよびWebアプリケーションのデプロイをサポートします。

ただし、プラグイン互換性レイヤーを使用せずにアプリケーションサーバーのメカニズムを使用して、@product@とともに通常のWebアプリケーションをデプロイできるということも覚えておいてください。

プラグインをアップグレードしたら、次のような最適化を検討できます。

  - プラグインを[Gradle](/docs/7-1/tutorials/-/knowledge_base/t/migrating-traditional-plugins-to-workspace-web-applications)またはMavenに移行して、開発コマンドと豊富な[Liferayプラグインテンプレート](/docs/7-1/tutorials/-/knowledge_base/t/developing-modules-with-liferay-workspace)を活用します。
  - [テーマをLiferay Theme Generatorに移行](/docs/7-0/tutorials/-/knowledge_base/t/migrating-a-6-2-theme-to-liferay-7)して、[テーマレット](/docs/7-1/tutorials/-/knowledge_base/t/creating-reusable-pieces-of-code-for-your-themes)（新規）を追加し、 [Node.js、Yeoman、およびGulp](/docs/7-1/tutorials/-/knowledge_base/t/creating-themes)を活用します。
  - [モジュールにプラグインを変換](/docs/7-1/tutorials/-/knowledge_base/t/modularizing-an-existing-portlet)して、宣言型サービス、拡張性などの[モジュラリティのメリット](/docs/7-1/tutorials/-/knowledge_base/t/osgi-and-modularity-for-liferay-6-developers)を活用します。
  - [Clay](/docs/7-1/tutorials/-/knowledge_base/t/applying-clay-styles-to-your-app)を使用して、明確で一貫したアプリケーションユーザーエクスペリエンスを適用します。

その他のオプションと詳細については、[optimization tutorials](/docs/7-1/tutorials/-/knowledge_base/t/optimizing-plugins-for-liferay-7)を参照してください。

プラグインSDKは、@product-ver@向けのプラグイン開発で利用できなくなりました。 プラグインSDKの削除については、記事[Deprecated Apps in 7.1: What To Do](/docs/7-1/deploy/-/knowledge_base/d/deprecated-apps-in-7-1-what-to-do#foundation)で詳細をご覧ください。

その削除の観点から、プラグインSDKから新しい環境のいずれかへプラグインの移行を検討する必要があります。

  - [Liferay Workspace](/docs/7-1/tutorials/-/knowledge_base/t/from-the-plugins-sdk-to-liferay-workspace)は、モジュールと従来のプラグインの開発をサポートするGradle環境です。 [Blade](/docs/7-1/tutorials/-/knowledge_base/t/migrating-traditional-plugins-to-workspace-web-applications)の[`migrateWar command`](/docs/7-1/tutorials/-/knowledge_base/t/migrating-traditional-plugins-to-workspace-web-applications)は、プラグインSDKポートレットをLiferay Workspace（ワークスペース）へすばやく移動します。
  - [LiferayのMaven](/docs/7-1/tutorials/-/knowledge_base/t/whats-new-for-maven-users)プラグインとアーキタイプは、モジュールと従来のプラグインの開発をサポートしています。 Mavenを使用するWorkspaceを生成するためのLiferay Workspaceアーキタイプもあります。

[Liferay @ide@](/docs/7-1/tutorials/-/knowledge_base/t/liferay-ide)は、Gradleまたは[Maven](/docs/7-1/tutorials/-/knowledge_base/t/using-maven-in-liferay-ide)を使用したWorkspaceでの開発をサポートしています。

適切に計画されたアップグレードと最適化は、時間と労力の削減になります。 アップグレードおよび最適化のチュートリアルについてより深く理解できるよう、さらに以下の項目について説明します。

  - アップグレードおよび最適化フェーズの説明
  - アップグレードおよび最適化パス

## アップグレードおよび最適化フェーズ

以下のアップグレードおよび最適化フェーズに従ってください。

1.  プラグインに該当する[upgrade tutorials](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-plugins-to-liferay-7)を参照してください。 アップグレードと最適化パスを調べます。

2.  プラグインをアップグレードし、@product-ver@で動作するために必要な最小限の変更のみを行います。

3.  （オプション）プラグインに対して最も有益な[最適化](/docs/7-1/tutorials/-/knowledge_base/t/optimizing-plugins-for-liferay-7)のみを特定して適用します。

4.  （オプション）必要に応じて追加の最適化を適用します。

### プラグインのアップグレードと最適化のパス

| プラグイン                                             | アップグレードパス                                                                                                                                                                                                                                                                                                                                                                                                           | 最適化（オプション）                                                                                                                                                                                                                                                                                                           |
|:------------------------------------------------- |:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Ext                                               | [Extプラグインを使用したカスタマイゼーション](/docs/7-0/tutorials/-/knowledge_base/t/advanced-customization-with-ext-plugins)                                                                                                                                                                                                                                                                                                           | 無し                                                                                                                                                                                                                                                                                                                   |
| フック - 言語ファイル                                      | \- [コア言語キーフックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-core-language-key-hooks)<br> - [ポートレット言語キーフックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-portlet-language-key-hooks)                                                                                                                                                                                                        | 同じ                                                                                                                                                                                                                                                                                                                   |
| フック - @product@コアJSPのオーバーライド                      | [コアJSPフックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-core-jsp-hooks)                                                                                                                                                                                                                                                                                                                                 | 同じ                                                                                                                                                                                                                                                                                                                   |
| フック - アプリケーションJSPのオーバーライド                         | [アプリケーションJSPフックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-app-jsp-hook-plugins)                                                                                                                                                                                                                                                                                                                     | 同じ                                                                                                                                                                                                                                                                                                                   |
| フック - イベント操作（ポータル/セッション/サーブレットサービス/シャットダウン/立ち上げ時） | [ポータルプロパティとイベント操作フックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-portal-property-and-event-action-hooks)                                                                                                                                                                                                                                                                                              | 無し                                                                                                                                                                                                                                                                                                                   |
| フック - モデルリスナー                                     | [モデルリスナーフックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-model-listener-hooks)                                                                                                                                                                                                                                                                                                                         | 同じ                                                                                                                                                                                                                                                                                                                   |
| フック - ポータルプロパティ                                   | [ポータルプロパティとイベント操作フックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-portal-property-and-event-action-hooks)                                                                                                                                                                                                                                                                                              | 同じ                                                                                                                                                                                                                                                                                                                   |
| フック - プロパティ                                       | \- もしプロパティが現在 [System Setting](/docs/7-1/user/-/knowledge_base/u/system-settings)であれば、そこで編集および/または`.config`ファイルを使用する<br> - プロパティが[liferay-hook.xml's DTD](@platform-ref@/7.1-latest/definitions/liferay-hook_7_1_0.dtd.html)にある場合は、[APIにコードを適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)させ、[依存関係を解決](/docs/7-1/tutorials/-/knowledge_base/t/resolving-a-plugins-dependencies)する             | 無し                                                                                                                                                                                                                                                                                                                   |
| フック - サービスラッパー                                    | [サービスラッパーのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-service-wrappers)                                                                                                                                                                                                                                                                                                                               | 無し                                                                                                                                                                                                                                                                                                                   |
| フック - サーブレットフィルター                                 | [サーブレットフィルターフックのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-servlet-filter-hooks)                                                                                                                                                                                                                                                                                                                     | 無し                                                                                                                                                                                                                                                                                                                   |
| フック - Struts操作                                    | \- [Struts操作 → Struts操作ラッパー](/docs/7-1/tutorials/-/knowledge_base/t/converting-strutsactionwrappers-to-mvccommands)<br> - [プロセス操作 → MVC操作コマンド](/docs/7-1/tutorials/-/knowledge_base/t/overriding-mvcactioncommand)<br> - [レンダー → MVCレンダーコマンド](/docs/7-1/tutorials/-/knowledge_base/t/overriding-mvcrendercommand)<br> - [リソース供給→MVCリソースコマンド](/docs/7-1/tutorials/-/knowledge_base/t/overriding-mvcresourcecommand) | 同じ                                                                                                                                                                                                                                                                                                                   |
| レイアウトテンプレート                                       | 1\. [APIにコードを適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)<br>2. [依存関係の解決](/docs/7-1/tutorials/-/knowledge_base/t/resolving-a-plugins-dependencies)<br>3. [レイアウトテンプレートのアップデート](/docs/7-1/tutorials/-/knowledge_base/t/creating-layout-templates-manually)                                                                                                                                    | \- [Liferay Theme Generatorへの移行](/docs/7-0/tutorials/-/knowledge_base/t/migrating-a-6-2-theme-to-liferay-7) (Node.js/Gulp/Yeoman)                                                                                                                                                                                   |
| ポートレット - GenericPortlet                           | [GenericPortletのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-a-genericportlet)                                                                                                                                                                                                                                                                                                                         | \- [Workspace/Gradleへの移行](/docs/7-1/tutorials/-/knowledge_base/t/migrating-traditional-plugins-to-workspace-web-applications)<br> - [クレイの適用](/docs/7-1/tutorials/-/knowledge_base/t/applying-clay-styles-to-your-app)<br> - [OSGiモジュールへ変換](/docs/7-1/tutorials/-/knowledge_base/t/modularizing-an-existing-portlet) |
| ポートレット - JSF                                      | [Liferay JSFポートレットのアップグレード](develop/tutorials/-/knowledge_base/7-1/upgrading-a-liferay-jsf-portlet)                                                                                                                                                                                                                                                                                                                 | 無し                                                                                                                                                                                                                                                                                                                   |
| ポートレット - Liferay MVC                              | [Liferay MVCポートレットのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-a-liferay-mvc-portlet)                                                                                                                                                                                                                                                                                                                 | \- [Workspace/Gradleへの移行](/docs/7-1/tutorials/-/knowledge_base/t/migrating-traditional-plugins-to-workspace-web-applications)<br> - [クレイの適用](/docs/7-1/tutorials/-/knowledge_base/t/applying-clay-styles-to-your-app)<br> - [OSGiモジュールへ変換](/docs/7-1/tutorials/-/knowledge_base/t/modularizing-an-existing-portlet) |
| ポートレット - サーブレット/JSP                               | [サーブレットベースのポートレットのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-a-servlet-based-portlet)                                                                                                                                                                                                                                                                                                                | 無し                                                                                                                                                                                                                                                                                                                   |
| ポートレット - Spring MVC                               | [Spring MVCポートレットのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-a-spring-mvc-portlet)                                                                                                                                                                                                                                                                                                                   | 無し                                                                                                                                                                                                                                                                                                                   |
| ポートレット - Struts 1                                 | [Strutsポートレットのアップグレード](/docs/7-0/tutorials/-/knowledge_base/t/upgrading-a-struts-portlet)                                                                                                                                                                                                                                                                                                                           | [StrustアクションラッパーをMVCコマンドへ変換](/docs/7-1/tutorials/-/knowledge_base/t/converting-strutsactionwrappers-to-mvccommands)                                                                                                                                                                                                  |
| テーマ                                               | 1\. [APIにコードを適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)<br>2. [依存関係の解決](/docs/7-1/tutorials/-/knowledge_base/t/resolving-a-plugins-dependencies)<br>3. [テーマのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-6-2-themes-intro)                                                                                                                                                   | \- [Liferay Theme Generatorへの移行](/docs/7-0/tutorials/-/knowledge_base/t/migrating-a-6-2-theme-to-liferay-7)(Node.js/Gulp/Yeoman)<br> - [Themeletsの使用](/docs/7-1/tutorials/-/knowledge_base/t/creating-reusable-pieces-of-code-for-your-themes)                                                                      |
| Webプラグイン                                          | 1\. [APIにコードを適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)<br>2. [依存関係の解決](/docs/7-1/tutorials/-/knowledge_base/t/resolving-a-plugins-dependencies)                                                                                                                                                                                                                                          | [OSGiモジュールへ変換](/docs/7-1/tutorials/-/knowledge_base/t/modularizing-an-existing-portlet) 例: `portlet-x-web`                                                                                                                                                                                                           |

### 機能のアップグレードと最適化のパス

| 特徴                                                 | アップグレードパス                                                                                                                                                                  | 最適化（オプション）                                                                                                                                                                                                       |
|:-------------------------------------------------- |:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| JNDIデータソース                                         | [@product@のクラスローダーを使用して、アプリケーションサーバーのJNDI APIにアクセスする](/docs/7-1/tutorials/-/knowledge_base/t/connecting-to-data-sources-using-jndi)                                        | 無し                                                                                                                                                                                                               |
| サービス - @product@コア、または別のポートレット、またはモジュールからサービスを呼び出す | [サービスTrackerを実装する](/docs/7-1/tutorials/-/knowledge_base/t/service-trackers)                                                                                                | [モジュールからLiferayサービスを呼び出す](/docs/7-1/tutorials/-/knowledge_base/t/invoking-local-services)                                                                                                                        |
| サービス - モジュールの依存関係                                  | `x-service.jar`を`WEB-INF/lib`にコピーする                                                                                                                                        | \- [Gradle/Mavenへの移行](/docs/7-1/tutorials/-/knowledge_base/t/migrating-traditional-plugins-to-workspace-web-applications)およびOSGiサービスで[依存関係を追加](/docs/7-1/tutorials/-/knowledge_base/t/configuring-dependencies) |
| サービス - Service Builder                             | [Service Builderを使用するポートレットのアップグレード](/docs/7-1/tutorials/-/knowledge_base/t/upgrading-portlets-that-use-service-builder)                                                   | [OSGiモジュールへ変換](/docs/7-1/tutorials/-/knowledge_base/t/modularizing-an-existing-portlet) 例: `x-api`および`x-service`                                                                                                 |
| サービス - Webサービス                                     | 1\. [APIにコードを適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)<br>2. [依存関係の解決](/docs/7-1/tutorials/-/knowledge_base/t/resolving-a-plugins-dependencies) | RESTサービスを前面に配置し、JAX-RSでService Builderサービスを使用                                                                                                                                                                    |
| テンプレート - FreeMarker                                | \- [APIにコードを適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)<br> - [テーマのテンプレートを適合](/docs/7-1/tutorials/-/knowledge_base/t/updating-theme-templates)    | 無し                                                                                                                                                                                                               |
| テンプレート - Velocity（非推奨）                             | [コードをAPIに適合](/docs/7-1/tutorials/-/knowledge_base/t/liferay-upgrade-planner)                                                                                               | [FreeMarkerに変換](/docs/7-1/tutorials/-/knowledge_base/t/updating-theme-templates)                                                                                                                                 |

これで、プラグインのアップグレードと最適化が完了しました。

---
header-id: publishing-staged-content-efficiently
---

# 段階的なコンテンツを効率的に公開する

<p class="alert alert-info"><span class="wysiwyg-color-blue120">ご覧のページは、お客様の利便性のために一部機械翻訳されています。また、ドキュメントは頻繁に更新が加えられており、翻訳は未完成の部分が含まれることをご了承ください。最新情報は都度公開されておりますため、必ず英語版をご参照ください。翻訳に問題がある場合は、<a href="mailto:support-content-jp@liferay.com">こちら</a>までご連絡ください。</span></p>

[TOC levels=1-4]

ステージングがどのように機能するかを理解したので、公開プロセスと、公開前に従う必要があるいくつかの前提条件について詳しく説明します。 プロセスがどのように機能するかを理解することで、サイトのコンテンツをどのように公開するかについて、情報に基づいた賢い決定を下すことができます。

## 公開プロセスについて

簡単に言えば、パブリケーションとは、すべてのコンテンツ、参照されているコンテンツ、アプリ、およびそれらの設定、ページなどのプロセスです。 ステージングスコープからライブサイトに転送されます。 リモートステージングを有効にしている場合、このプロセスには別のリモートサイトとのネットワーク通信が含まれます。 低レベルの観点から見ると、ステージングはエンティティが別の場所にミラーリングされる同値関係です。 高レベルの観点から、ステージングプロセスは3つのフェーズで発生します。

1.  **エクスポート：** は、サイトのコンテンツとアプリを定義するパブリケーション構成を処理します。 このフェーズでは、ライブサイトで必要とされる必須の参照エンティティも収集します。 次に、パブリケーションパラメータに応じてすべてがインスタンス独自のファイル形式に処理され、そのファイルはローカルに保存されるか、リモートのライブLiferayインスタンスに転送されます。

2.  **検証：** は、インポートプロセスを開始できるかどうかを決定します。 このフェーズでは、ファイルのバージョンとその整合性を検証し、言語設定などの追加のシステム情報をチェックし、参照されているコンテンツが欠落していないことを確認します。

3.  **インポート：** は、公開パラメーターに従って、サイトのコンテンツ、レイアウト、およびアプリに必要な更新または追加を行います。 すべてが検証され、正しい場合は、ステージングされたコンテンツがライブサイトに公開されます。

これらのフェーズは順次実行されます。

段階的なコンテンツを正常に公開するための重要な要素は、データの整合性です。 パブリケーションプロセス中に何も検証されない場合、トランザクションデータベースはサイトを元の状態に戻し、現在のパブリケーションを破棄します。 これは、適切に設計されたライブサイトを破壊する可能性がある不完全な情報の公開を防ぐために必要なアクションです。

ファイルシステムがない場合には *データベースに格納された* （例えば、DBStore）、それはトランザクションではありませんし、ステージング障害が発生した場合に元に戻されていません。 これにより、データベース内のファイルとその参照の間に矛盾が生じる可能性があります。 このため、管理者はドキュメントライブラリのステージングに細心の注意を払い、データベースとファイルシステムの両方の定期的なバックアップが維持されていることを確認する必要があります。

次に、ステージングのベストプラクティスと、シームレスなステージングエクスペリエンスを実現するための前提条件について学習します。

## ステージングの事前計画

ステージングは、柔軟でスケーラブルな複雑なサブシステムです。 上級ユーザーや管理者がサイトで使用する前に、シームレスなプロセスのための事前の計画といくつかのヒントを覚えておくことは重要です。 評価するいくつかの要因があります。

  - **コンテンツ（量、タイプ、および構造）：** サイトのコンテンツに応じて、必要なコンテンツタイプのみのステージングをオンにし、他のコンテンツタイプはオフにして、不要な作業を回避できます。 特定の種類のコンテンツのみを公開するように公開を構成することもできます。 詳細については、 [コンテンツタイプの管理](/docs/7-1/user/-/knowledge_base/u/managing-content-types-in-staging) 記事を参照してください。

  - **ハードウェア環境：** コンテンツタイプに応じて環境を計画する必要があります。 サイトが大きな画像や動画ファイルで動作している場合は、共有ネットワークドライブが最適なオプションかどうかを判断します。 多くの大きな画像をドキュメントライブラリに保存するには、通常、より高速なネットワークまたはローカルストレージが必要です。 ただし、Webコンテンツを処理している場合、これらは通常小さく、ディスク容量をほとんど消費しません。

  - **あなたのステージング環境のためのカスタマイズとカスタム・ロジック：** あなたの組織のビジネスロジックが最も可能性の高いアプリに実装され、そしてあなたがそのアプリのサポートステージングする場合は、あなたがしなければならない [書き込みいくつかのコード](/docs/7-1/tutorials/-/knowledge_base/t/export-import-and-staging) 、これを達成するために。 ステージング環境のルックアンドフィールを変更する場合は、新しいJSPコードを記述してデフォルトのUI設定を変更することも検討できます。

サイトの計画が完了したら、サイト作成プロセスの最初にステージングをオンにする必要があります。 これにより、サイトの作成者は、実行に長時間かかる可能性のある巨大なパブリケーションを待つことを回避できます。 サイトがゼロから構築されるため、公開プロセス全体を通してより小さなステップを踏むことで、反復的なクリエイティブプロセスが形成されます。コンテンツ作成者は変更をすぐに公開し、長い待ち時間を回避できます。

ステージングに関するJVM /ネットワーク構成の推奨事項を以下に示します。

  - 4 GBのメモリ

  - 最小転送速度20 MB /秒（ディスク）

ステージング環境がどのように機能し、サイトで有効にする方法がわかったので、次のセクションで使用を開始します。
